{"ts":1378268560612,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1378268635872,"patch":[[{"diffs":[[1,"var Model = function(){\n    this.name = \"\";\n    this.listenerMap = {};\n};\n\nModel.prototype.setName = function(newName){\n    this.name = newName;\n    this.trigger(\"nameChanged\", newName);\n};\n\nModel.prototype.setReports = function(reports){\n    this.reports = reports;\n    this.trigger(\"reportChanged\", reports);\n};\n\nModel.prototype.trigger = function(eventName, data){\n    console.log(eventName);\n    var listeners = this.listenerMap[eventName];\n    console.log(listeners);\n    var listener;\n    for(var i=0;listeners&&i<listeners.length;i++){\n        listener = listeners[i];\n        if(listener && typeof listener.func==\"function\" && listener.event===eventName){\n            listener.func.call(listener.obj, data);\n        }\n    }\n};\n\nModel.prototype.addListener = function(event, func, obj){\n    // should check if already registered\n    var listeners = this.listenerMap[event];\n    if(!listeners){\n        listeners = [];\n    }\n    listeners.push({event:event, func: func, obj: obj});\n    this.listenerMap[event] = listeners;\n    console.log(\"add listener@\" + event);\n};\n\nvar View = function(name){\n    this. name= name;\n};\n\nView.prototype.update = function(data){\n    console.log(this.name + \":\" + data);\n};\n\nvar Controller = function(actions){\n    for(var i=0;i<actions.length;i++){\n        var action = actions[i];\n        var _model = action.model;\n        _model.addListener(action.event, action.func, action.obj);\n    }\n};\n\nvar model = new Model();\nvar view1 = new View(\"view1\");\nvar view2 = new View(\"view2\");\nvar controller = new Controller([\n    {'model': model, 'event': 'nameChanged', 'func': view1.update, 'obj': view1},\n    {'model': model, 'event': 'reportChanged', 'func': view2.update, 'obj': view2}\n]);\n\nmodel.setName(\"new name here\");\nmodel.setReports(['a','b']);"]],"start1":0,"start2":0,"length1":0,"length2":1784}]],"length":1784,"saved":false}
